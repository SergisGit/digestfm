!function(){"use strict";var t,s=$("body"),e=$(".js-letterBtn"),n=$("#js-letterPopup"),a=n.find("#js-letterForm"),o=$('meta[name="csrf-token"]');if(o.length&&(t=o.attr("content")),a.length){var i=a.attr("action"),c=n.find("#js-workerInput"),l=n.find("input,textarea"),r=n.find("#js-letterMsg"),p=n.find("#js-letterError"),d=n.find("#js-letterErrorBtn"),f=n.find("#js-letterOkBtn"),u=a.siblings(".popup__close-btn");$.each(e,function(e){var t=$(this),o=t.attr("data-id");t.on("click",function(){c.length&&o&&c.val(o),function(e,t){var o=e.find(".popup__msg");o.length&&o.removeClass("popup__msg--active"),t.length&&t.removeClass("hide-block"),s.addClass("overflow"),e.addClass("popup--active");var n=e.find(".popup__close-btn");function a(){n.off("click"),$(window).off("keydown.popup"),s.removeClass("overflow"),e.removeClass("popup--active")}n.on("click",function(){a()}),$(window).on("keydown.popup",function(e){27===e.keyCode&&a()})}(n,a)})}),a.on("submit",function(e){e.preventDefault();var o=new FormData;t&&o.append("_token",t),$.each(l,function(e){var t=$(this);o.append(t.attr("name"),t.val()),e!==l.length-1||l.hasClass("error")||$.ajax(i,{method:"POST",data:o,processData:!1,contentType:!1,success:function(){a.addClass("hide-block"),r.addClass("popup__msg--active"),l.val(""),f.on("click",function(){u.length&&u.trigger("click"),r.removeClass("popup__msg--active"),a.removeClass("hide-block"),f.off("click")})},error:function(){a.addClass("hide-block"),p.addClass("popup__msg--active"),d.on("click",function(){p.removeClass("popup__msg--active"),a.removeClass("hide-block"),d.off("click")})}})})})}}();